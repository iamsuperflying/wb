#!name=微博去广告

#!desc=微博去广告

#!icon=https://raw.githubusercontent.com/iamsuperflying/wb/refs/heads/master/weiboadguard.png

#!author=roc

[MITM]

hostname = api.weibo.cn, mapi.weibo.com, *.uve.weibo.com, new.vip.weibo.cn, wbapp.mobile.sina.cn, mi.gdt.qq.com, tqt.weibo.cn

[script]

# 热搜等
http-response ^https?://m?api\.weibo\.c(n|om)/2/(cardlist|searchall|page|messageflow|statuses/(unread_)?friends(/|_)timeline|groups/timeline|statuses/(unread_hot_timeline|extend|video_mixtimeline)|profile/(me|statuses)|video/(community_tab|remind_info|tiny_stream_video_list)|checkin/show|\!/live/media_homelist|comments/build_comments|container/get_item|search/(finder|container_timeline|container_discover)) requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/loon.js,tag=热搜及时间线净化

# 用户信息
http-response ^https?://m?api\.weibo\.c(n|om)/2/users/show\? requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/loon.js,tag=用户信息净化

# http-response ^https://api\.weibo\.cn/2/(groups|video|statuses|search|profile|comments)/(allgroups|timeline|tiny_stream_video_list|container_timeline_hot|finder|container_discover|container_timeline|me|build_comments|extend|userinfo)|(page)|(searchall) requires-body =1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/index.js

# statuses 去广告
# container_detail_comment: 评论内容
http-response ^https?:\/\/api\.weibo\.cn\/2\/statuses\/(container_timeline|container_detail_comment|container_detail) script-path = https://raw.githubusercontent.com/iamsuperflying/wb/master/statuses.js, requires-body = true, tag = Statuses接口

# Profile 时间线接口
# 接口路径：/2/profile/container_timeline
# 行为：拦截响应体并执行脚本修改
# 说明：用于个人页 / 时间线去广告与内容清洗
# 前提：需开启 MITM，并包含 api.weibo.cn
http-response ^https?:\/\/api\.weibo\.cn\/2\/profile\/container_timeline script-path = https://raw.githubusercontent.com/iamsuperflying/wb/master/profile.js, requires-body = true, tag = Profile接口净化

# 修改微博时间线请求体中的 preAdInterval 参数
# http-request ^https://api\.weibo\.cn/2/statuses/container_timeline script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/modify_request.js, requires-body=true, tag=修改preAdInterval参数, enable=true

# 微博开屏广告
http-response ^https?://.*?.uve.weibo.com/(v\d+/ad/preload|wbapplua/wbpullad.lua) requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/launch/launch-guard.js,tag=微博开屏广告

# 微博开屏广告 (wbapp.mobile.sina.cn)
http-response ^https?://wbapp\.mobile\.sina\.cn/wbapplua/wbpullad\.lua requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/launch/launch-guard.js,tag=微博开屏广告2

# 微博轻享版开屏广告
# http-response ^https://.*?.uve.weibo.com/interface/sdk/sdkad.php requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/launch/qx.launch-guard.js,tag=微博轻享版开屏广告
# http-response ^https://mi.gdt.qq.com/gdt_mview.fcg requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/launch/qx.launch-guard.js,tag=腾讯广告
# http-response ^https://tqt.weibo.cn/api/fortune/decisionMaker requires-body=1,script-path=https://raw.githubusercontent.com/iamsuperflying/wb/master/launch/qx.launch-guard.js,tag=微博运势广告
